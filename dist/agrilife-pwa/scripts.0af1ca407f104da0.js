!function(D){Date.now=Date.now||function(){return(new Date).getTime()};var c={extend:function(){arguments[0]=arguments[0]||{};for(var i=1;i<arguments.length;i++)for(var e in arguments[i])arguments[i].hasOwnProperty(e)&&(arguments[0][e]="object"==typeof arguments[i][e]?arguments[i][e]instanceof Array?arguments[i][e]:c.extend(arguments[0][e],arguments[i][e]):arguments[i][e]);return arguments[0]},binarySearch:function(i,e){for(var a=0,r=i.length;a<r;){var o=a+r>>1;e<i[o][0]?r=o:a=o+1}return a},pixelSnap:function(i,e){return e%2==0?Math.round(i):Math.floor(i)+.5}};function S(i){this.options=c.extend({},S.defaultOptions,i),this.disabled=!1,this.clear()}function l(i){this.options=c.extend({},l.defaultChartOptions,i),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0,this.lastRenderTimeMillis=0,this.lastChartTimestamp=0,this.mousemove=this.mousemove.bind(this),this.mouseout=this.mouseout.bind(this)}S.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},S.prototype.clear=function(){this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN},S.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var i=1;i<this.data.length;i++){var e=this.data[i][1];e>this.maxValue&&(this.maxValue=e),e<this.minValue&&(this.minValue=e)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},S.prototype.append=function(i,e,a){if(!isNaN(i)&&!isNaN(e)){var r=this.data.length-1;if(r>=0)for(var o=r;;){var t=this.data[o];if(i>=t[0]){i===t[0]?a?(t[1]+=e,e=t[1]):t[1]=e:this.data.splice(o+1,0,[i,e]);break}if(--o<0){this.data.splice(0,0,[i,e]);break}}else this.data.push([i,e]);this.maxValue=isNaN(this.maxValue)?e:Math.max(this.maxValue,e),this.minValue=isNaN(this.minValue)?e:Math.min(this.minValue,e)}},S.prototype.dropOldData=function(i,e){for(var a=0;this.data.length-a>=e&&this.data[a+1][0]<i;)a++;0!==a&&this.data.splice(0,a)},l.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(i,e){return parseFloat(i).toFixed(e)},yMaxFormatter:function(i,e){return parseFloat(i).toFixed(e)},yIntermediateFormatter:function(i,e){return parseFloat(i).toFixed(e)},maxValueScale:1,minValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,scrollBackwards:!1,displayDataFromPercentile:1,grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:2,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2,showIntermediateLabels:!1,intermediateLabelSameAxis:!0},title:{text:"",fillStyle:"#ffffff",fontSize:15,fontFamily:"monospace",verticalAlign:"middle"},horizontalLines:[],tooltip:!1,tooltipLine:{lineWidth:1,strokeStyle:"#BBBBBB"},tooltipFormatter:l.tooltipFormatter=function(i,e){var o,a=this.options.timestampFormatter||l.timeFormatter,r=document.createElement("div");r.appendChild(document.createTextNode(a(new Date(i))));for(var t=0;t<e.length;++t){""!==(o=e[t].series.options.tooltipLabel||"")&&(o+=" ");var s=document.createElement("span");s.style.color=e[t].series.options.strokeStyle,s.appendChild(document.createTextNode(o+this.options.yMaxFormatter(e[t].value,this.options.labels.precision))),r.appendChild(document.createElement("br")),r.appendChild(s)}return r.innerHTML},nonRealtimeData:!1,responsive:!1,limitFPS:0},l.AnimateCompatibility={requestAnimationFrame:function(a,r){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t(Date.now())},16)}).call(window,a,r)},cancelAnimationFrame:function(a){return(window.cancelAnimationFrame||function(o){clearTimeout(o)}).call(window,a)}},l.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},l.prototype.addTimeSeries=function(i,e){this.seriesSet.push({timeSeries:i,options:c.extend({},l.defaultSeriesPresentationOptions,e)}),i.options.resetBounds&&i.options.resetBoundsInterval>0&&(i.resetBoundsTimerId=setInterval(function(){i.resetBounds()},i.options.resetBoundsInterval))},l.prototype.removeTimeSeries=function(i){for(var e=this.seriesSet.length,a=0;a<e;a++)if(this.seriesSet[a].timeSeries===i){this.seriesSet.splice(a,1);break}i.resetBoundsTimerId&&clearInterval(i.resetBoundsTimerId)},l.prototype.getTimeSeriesOptions=function(i){for(var e=this.seriesSet.length,a=0;a<e;a++)if(this.seriesSet[a].timeSeries===i)return this.seriesSet[a].options},l.prototype.bringToFront=function(i){for(var e=this.seriesSet.length,a=0;a<e;a++)if(this.seriesSet[a].timeSeries===i){var r=this.seriesSet.splice(a,1);this.seriesSet.push(r[0]);break}},l.prototype.streamTo=function(i,e){this.canvas=i,this.clientWidth=parseInt(this.canvas.getAttribute("width")),this.clientHeight=parseInt(this.canvas.getAttribute("height")),this.delay=e,this.start()},l.prototype.getTooltipEl=function(){return this.tooltipEl||(this.tooltipEl=document.createElement("div"),this.tooltipEl.className="smoothie-chart-tooltip",this.tooltipEl.style.pointerEvents="none",this.tooltipEl.style.position="absolute",this.tooltipEl.style.display="none",document.body.appendChild(this.tooltipEl)),this.tooltipEl},l.prototype.updateTooltip=function(){if(this.options.tooltip){var i=this.getTooltipEl();if(!this.mouseover||!this.options.tooltip)return void(i.style.display="none");for(var e=this.lastChartTimestamp,a=this.options.scrollBackwards?e-this.mouseX*this.options.millisPerPixel:e-(this.clientWidth-this.mouseX)*this.options.millisPerPixel,r=[],o=0;o<this.seriesSet.length;o++){var t=this.seriesSet[o].timeSeries;if(!t.disabled){var s=c.binarySearch(t.data,a);s>0&&s<t.data.length&&r.push({series:this.seriesSet[o],index:s,value:t.data[s][1]})}}r.length?(i.innerHTML=this.options.tooltipFormatter.call(this,a,r),i.style.display="block"):i.style.display="none"}},l.prototype.mousemove=function(i){if(this.mouseover=!0,this.mouseX=i.offsetX,this.mouseY=i.offsetY,this.mousePageX=i.pageX,this.mousePageY=i.pageY,this.options.tooltip){var e=this.getTooltipEl();e.style.top=Math.round(this.mousePageY)+"px",e.style.left=Math.round(this.mousePageX)+"px",this.updateTooltip()}},l.prototype.mouseout=function(){this.mouseover=!1,this.mouseX=this.mouseY=-1,this.tooltipEl&&(this.tooltipEl.style.display="none")},l.prototype.resize=function(){var e,a,i=this.options.enableDpiScaling&&window?window.devicePixelRatio:1;this.options.responsive?(a=this.canvas.offsetHeight,(e=this.canvas.offsetWidth)!==this.lastWidth&&(this.lastWidth=e,this.canvas.setAttribute("width",Math.floor(e*i).toString()),this.canvas.getContext("2d").scale(i,i)),a!==this.lastHeight&&(this.lastHeight=a,this.canvas.setAttribute("height",Math.floor(a*i).toString()),this.canvas.getContext("2d").scale(i,i)),this.clientWidth=e,this.clientHeight=a):(e=parseInt(this.canvas.getAttribute("width")),a=parseInt(this.canvas.getAttribute("height")),1!==i?(Math.floor(this.clientWidth*i)!==e&&(this.canvas.setAttribute("width",Math.floor(e*i).toString()),this.canvas.style.width=e+"px",this.clientWidth=e,this.canvas.getContext("2d").scale(i,i)),Math.floor(this.clientHeight*i)!==a&&(this.canvas.setAttribute("height",Math.floor(a*i).toString()),this.canvas.style.height=a+"px",this.clientHeight=a,this.canvas.getContext("2d").scale(i,i))):(this.clientWidth=e,this.clientHeight=a))},l.prototype.start=function(){if(!this.frame){this.canvas.addEventListener("mousemove",this.mousemove),this.canvas.addEventListener("mouseout",this.mouseout);var i=function(){this.frame=l.AnimateCompatibility.requestAnimationFrame(function(){if(this.options.nonRealtimeData){var e=new Date(0),a=this.seriesSet.reduce(function(r,o){var t=o.timeSeries.data,s=Math.round(this.options.displayDataFromPercentile*t.length)-1;if(s=(s=s>=0?s:0)<=t.length-1?s:t.length-1,t&&t.length>0){var n=t[s][0];r=r>n?r:n}return r}.bind(this),e);this.render(this.canvas,a>e?a:null)}else this.render();i()}.bind(this))}.bind(this);i()}},l.prototype.stop=function(){this.frame&&(l.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame,this.canvas.removeEventListener("mousemove",this.mousemove),this.canvas.removeEventListener("mouseout",this.mouseout))},l.prototype.updateValueRange=function(){for(var i=this.options,e=Number.NaN,a=Number.NaN,r=0;r<this.seriesSet.length;r++){var o=this.seriesSet[r].timeSeries;o.disabled||(isNaN(o.maxValue)||(e=isNaN(e)?o.maxValue:Math.max(e,o.maxValue)),isNaN(o.minValue)||(a=isNaN(a)?o.minValue:Math.min(a,o.minValue)))}if(null!=i.maxValue?e=i.maxValue:e*=i.maxValueScale,null!=i.minValue?a=i.minValue:a-=Math.abs(a*i.minValueScale-a),this.options.yRangeFunction){var t=this.options.yRangeFunction({min:a,max:e});a=t.min,e=t.max}if(!isNaN(e)&&!isNaN(a)){var n=e-a-this.currentValueRange,w=a-this.currentVisMinValue;this.isAnimatingScale=Math.abs(n)>.1||Math.abs(w)>.1,this.currentValueRange+=i.scaleSmoothing*n,this.currentVisMinValue+=i.scaleSmoothing*w}this.valueRange={min:a,max:e}},l.prototype.render=function(i,e){var a=Date.now();if(!(this.options.limitFPS>0&&a-this.lastRenderTimeMillis<1e3/this.options.limitFPS)){if(!(e=(e||a)-(this.delay||0),e-=e%this.options.millisPerPixel,this.isAnimatingScale||this.lastChartTimestamp!==e||a-this.lastRenderTimeMillis>166.66666666666666))return;this.lastRenderTimeMillis=a,this.lastChartTimestamp=e,this.resize();var t=(i=i||this.canvas).getContext("2d"),s=this.options,n={top:0,left:0,width:this.clientWidth,height:this.clientHeight},w=e-n.width*s.millisPerPixel,M=function(h,u){return c.pixelSnap(0===this.currentValueRange?n.height:n.height*(1-(h-this.currentVisMinValue)/this.currentValueRange),u)}.bind(this),T=function(h,u){return c.pixelSnap(s.scrollBackwards?(e-h)/s.millisPerPixel:n.width-(e-h)/s.millisPerPixel,u)};if(this.updateValueRange(),t.font=s.labels.fontSize+"px "+s.labels.fontFamily,t.save(),t.translate(n.left,n.top),t.beginPath(),t.rect(0,0,n.width,n.height),t.clip(),t.save(),t.fillStyle=s.grid.fillStyle,t.clearRect(0,0,n.width,n.height),t.fillRect(0,0,n.width,n.height),t.restore(),t.save(),t.lineWidth=s.grid.lineWidth,t.strokeStyle=s.grid.strokeStyle,s.grid.millisPerLine>0){t.beginPath();for(var d=e-e%s.grid.millisPerLine;d>=w;d-=s.grid.millisPerLine){var m=T(d,s.grid.lineWidth);t.moveTo(m,0),t.lineTo(m,n.height)}t.stroke(),t.closePath()}for(var f=1;f<s.grid.verticalSections;f++){var P=c.pixelSnap(f*n.height/s.grid.verticalSections,s.grid.lineWidth);t.beginPath(),t.moveTo(0,P),t.lineTo(n.width,P),t.stroke(),t.closePath()}if(s.grid.borderVisible&&(t.beginPath(),t.strokeRect(0,0,n.width,n.height),t.closePath()),t.restore(),s.horizontalLines&&s.horizontalLines.length)for(var A=0;A<s.horizontalLines.length;A++){var k=s.horizontalLines[A],q=k.lineWidth||1,Y=M(k.value,q);t.strokeStyle=k.color||"#ffffff",t.lineWidth=q,t.beginPath(),t.moveTo(0,Y),t.lineTo(n.width,Y),t.stroke(),t.closePath()}for(var F=0;F<this.seriesSet.length;F++){var B=this.seriesSet[F].timeSeries,y=B.data;if(B.dropOldData(w,s.maxDataSetLength),!(y.length<=1||B.disabled)){t.save();var p=this.seriesSet[F].options,X=p.strokeStyle&&"none"!==p.strokeStyle,x=X?p.lineWidth:0;t.beginPath();var N,R=T(y[0][0],x),O=M(y[0][1],x),L=R,j=O;switch(t.moveTo(R,O),p.interpolation||s.interpolation){case"linear":case"line":N=function(h,u,v,b){t.lineTo(h,u)};break;case"bezier":default:N=function(h,u,v,b){t.bezierCurveTo(Math.round((v+h)/2),b,Math.round(v+h)/2,u,h,u)};break;case"step":N=function(h,u,v,b){t.lineTo(h,b),t.lineTo(h,u)}}for(var C=1;C<y.length;C++){var G=y[C],J=T(G[0],x),K=M(G[1],x);N(J,K,L,j),L=J,j=K}X&&(t.lineWidth=p.lineWidth,t.strokeStyle=p.strokeStyle,t.stroke()),p.fillStyle&&(t.lineTo(L,n.height+x+1),t.lineTo(R,n.height+x+1),t.fillStyle=p.fillStyle,t.fill()),t.restore()}}s.tooltip&&this.mouseX>=0&&(t.lineWidth=s.tooltipLine.lineWidth,t.strokeStyle=s.tooltipLine.strokeStyle,t.beginPath(),t.moveTo(this.mouseX,0),t.lineTo(this.mouseX,n.height),t.closePath(),t.stroke()),this.updateTooltip();var g=s.labels;if(!g.disabled&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)){var Q=s.yMaxFormatter(this.valueRange.max,g.precision),V=s.yMinFormatter(this.valueRange.min,g.precision),_=s.scrollBackwards?0:n.width-t.measureText(Q).width-2,$=s.scrollBackwards?0:n.width-t.measureText(V).width-2;t.fillStyle=g.fillStyle,t.fillText(Q,_,g.fontSize),t.fillText(V,$,n.height-2)}if(g.showIntermediateLabels&&!isNaN(this.valueRange.min)&&!isNaN(this.valueRange.max)&&s.grid.verticalSections>0){var U=(this.valueRange.max-this.valueRange.min)/s.grid.verticalSections,Z=n.height/s.grid.verticalSections;for(f=1;f<s.grid.verticalSections;f++){P=n.height-Math.round(f*Z);var E=s.yIntermediateFormatter(this.valueRange.min+f*U,g.precision),tt=g.intermediateLabelSameAxis?s.scrollBackwards?0:n.width-t.measureText(E).width-2:s.scrollBackwards?n.width-t.measureText(E).width-2:0;t.fillText(E,tt,P-s.grid.lineWidth)}}if(s.timestampFormatter&&s.grid.millisPerLine>0){var W=s.scrollBackwards?t.measureText(V).width:n.width-t.measureText(V).width+4;for(d=e-e%s.grid.millisPerLine;d>=w;d-=s.grid.millisPerLine)if(m=T(d,0),!s.scrollBackwards&&m<W||s.scrollBackwards&&m>W){var et=new Date(d),z=s.timestampFormatter(et),I=t.measureText(z).width;W=s.scrollBackwards?m+I+2:m-I-2,t.fillStyle=s.labels.fillStyle,t.fillText(z,s.scrollBackwards?m:m-I,n.height-2)}}if(""!==s.title.text){t.font=s.title.fontSize+"px "+s.title.fontFamily;var it=s.scrollBackwards?n.width-t.measureText(s.title.text).width-2:2;if("bottom"==s.title.verticalAlign){t.textBaseline="bottom";var H=n.height}else"middle"==s.title.verticalAlign?(t.textBaseline="middle",H=n.height/2):(t.textBaseline="top",H=0);t.fillStyle=s.title.fillStyle,t.fillText(s.title.text,it,H)}t.restore()}},l.timeFormatter=function(i){function e(a){return(a<10?"0":"")+a}return e(i.getHours())+":"+e(i.getMinutes())+":"+e(i.getSeconds())},D.TimeSeries=S,D.SmoothieChart=l}(typeof exports>"u"?this:exports);